<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Gia pháº£ dÃ²ng há» LÃª ÄÃ¬nh</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://d3js.org/d3.v7.min.js"></script>

<style>
body{
  font-family:"Times New Roman",serif;
  margin:0;
  padding:30px;
  background:url("https://tranhnhatthanh.vn/wp-content/uploads/2024/07/tranh-lang-que-viet-nam-xua-14.jpg")
  no-repeat center/cover fixed;
}

.main{
  background:rgba(255,255,255,0.95);
  max-width:1200px;
  margin:auto;
  padding:30px 40px;
  box-shadow:0 0 30px rgba(0,0,0,0.4);
}

.menu{text-align:center;margin:20px 0}
.menu button{padding:6px 16px;font-weight:bold}

.section{display:none}
.section.active{display:block}

label{display:inline-block;width:160px}
input,select{width:280px;margin-bottom:6px}

.wrapper{height:70vh;border:1px solid #ccc;overflow:auto}
svg{width:3500px;height:2500px}

.node rect{fill:#fff;stroke:#333;rx:6}
.link{fill:none;stroke:#888}
</style>
</head>

<body>
<div class="main">

<h1 style="text-align:center">GIA PHáº¢ DÃ’NG Há»Œ LÃŠ ÄÃŒNH</h1>

<div class="menu">
  <button onclick="show('home')">ğŸ  Trang chá»§</button>
  <button onclick="show('manage')">âœï¸ Quáº£n lÃ½</button>
  <button onclick="show('tree')">ğŸŒ³ Gia pháº£</button>
</div>

<!-- ================= HOME ================= -->
<div id="home" class="section active">
  <h2 style="text-align:center">Lá»œI GIá»šI THIá»†U</h2>
  <p>Gia pháº£ lÃ  sá»£i dÃ¢y ná»‘i liá»n cÃ¡c tháº¿ há»‡, lÃ  nÆ¡i lÆ°u giá»¯ cá»™i nguá»“n, cÃ´ng Ä‘á»©c tá»• tiÃªn vÃ  truyá»n thá»‘ng cá»§a dÃ²ng há» qua bao Ä‘á»i.</p>
  <p>DÃ²ng há» LÃª láº¥y <b>Thá»§y Tá»• â€“ Cá»¥ LÃª ÄÃ¬nh Cai</b>, con trai HoÃ ng thÃ¢n LÃª Duy Máº­t lÃ m gá»‘c.</p>
</div>

<!-- ================= MANAGE ================= -->
<div id="manage" class="section">
<h3>ThÃªm / chá»‰nh sá»­a thÃ nh viÃªn</h3>

<label>Chá»n CHA:</label>
<select id="parentSelect"></select><br>

<label>Há» tÃªn:</label>
<input id="nameInput"><br>

<label>Con thá»© máº¥y:</label>
<input id="orderInput" type="number" min="1"><br>

<label>NÄƒm sinh:</label>
<input id="birthInput"><br>

<label>QuÃª quÃ¡n:</label>
<input id="homeInput"><br>

<label>NgÃ y giá»—:</label>
<input id="deathInput"><br><br>

<button onclick="add()">â• ThÃªm ngÆ°á»i</button>
<button onclick="update()">âœï¸ Cáº­p nháº­t</button>
</div>

<!-- ================= TREE ================= -->
<div id="tree" class="section">
<div class="wrapper"><svg></svg></div>
</div>

</div>

<script>
function show(id){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* ===== DATA ===== */
let idGen=1;
const data={
  id:idGen++,
  name:"Thá»§y Tá»• â€“ LÃª ÄÃ¬nh Cai",
  doi:1,
  gio:"Giá»— Tá»•: 17 thÃ¡ng GiÃªng",
  children:[]
};

let selectedNode=null;

function nodes(root,arr=[]){
  arr.push(root);
  (root.children||[]).forEach(c=>nodes(c,arr));
  return arr;
}

/* ===== DROPDOWN ===== */
function refresh(){
  parentSelect.innerHTML="";
  nodes(data).forEach(n=>{
    let o=document.createElement("option");
    o.value=n.id;
    o.text=n.name+" (Äá»i "+n.doi+")";
    parentSelect.appendChild(o);
  });
}

/* ===== ADD ===== */
function add(){
  let parent=nodes(data).find(n=>n.id==parentSelect.value);
  if(!parent.children) parent.children=[];

  parent.children.push({
    id:idGen++,
    name:nameInput.value,
    doi:parent.doi+1,
    order:orderInput.value,
    birth:birthInput.value,
    home:homeInput.value,
    gio:deathInput.value,
    children:[]
  });

  clear();
  refresh();
  draw();
}

/* ===== UPDATE (sá»­a ngÆ°á»i Ä‘ang chá»n trÃªn cÃ¢y) ===== */
function update(){
  if(!selectedNode){alert("Báº¥m vÃ o ngÆ°á»i trÃªn cÃ¢y Ä‘á»ƒ sá»­a");return;}
  if(selectedNode.id===data.id){alert("KhÃ´ng sá»­a Thá»§y Tá»•");return;}

  selectedNode.name=nameInput.value;
  selectedNode.order=orderInput.value;
  selectedNode.birth=birthInput.value;
  selectedNode.home=homeInput.value;
  selectedNode.gio=deathInput.value;

  clear();
  draw();
}

/* ===== CLEAR ===== */
function clear(){
  nameInput.value=orderInput.value=birthInput.value=homeInput.value=deathInput.value="";
}

/* ===== DRAW TREE ===== */
function draw(){
  d3.select("svg").selectAll("*").remove();
  let g=d3.select("svg").append("g").attr("transform","translate(150,300)");
  let root=d3.hierarchy(data);
  d3.tree().nodeSize([100,260])(root);

  g.selectAll(".link")
    .data(root.links()).enter().append("path")
    .attr("class","link")
    .attr("d",d3.linkHorizontal().x(d=>d.y).y(d=>d.x));

  let node=g.selectAll(".node")
    .data(root.descendants()).enter().append("g")
    .attr("class","node")
    .attr("transform",d=>`translate(${d.y},${d.x})`)
    .on("click",(e,d)=>{
      selectedNode=d.data;
      nameInput.value=d.data.name;
      orderInput.value=d.data.order||"";
      birthInput.value=d.data.birth||"";
      homeInput.value=d.data.home||"";
      deathInput.value=d.data.gio||"";
      show('manage');
    });

  node.append("rect").attr("x",-100).attr("y",-40).attr("width",200).attr("height",80);
  node.append("text").attr("y",-10).attr("text-anchor","middle").text(d=>d.data.name);
  node.append("text").attr("y",10).attr("text-anchor","middle")
    .style("font-size","12px")
    .text(d=>d.data.id===data.id?"Thá»§y Tá»•":"Äá»i "+d.data.doi+" â€“ Con "+d.data.order);
}

refresh();
draw();
</script>

</body>
</html>
