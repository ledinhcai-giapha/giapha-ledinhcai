<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Gia pháº£ dÃ²ng há» LÃª ÄÃ¬nh</title>
<script src="https://d3js.org/d3.v7.min.js"></script>

<style>
body{
  font-family:"Times New Roman",serif;
  margin:0;
  padding:30px;
  background:url("https://tranhnhatthanh.vn/wp-content/uploads/2024/07/tranh-lang-que-viet-nam-xua-14.jpg")
    no-repeat center center fixed;
  background-size:cover;
}
.main{
  background:rgba(255,255,255,0.92);
  max-width:1200px;
  margin:auto;
  padding:40px 50px;
  border-radius:14px;
  box-shadow:0 10px 30px rgba(0,0,0,0.15);
}
.menu{text-align:center;margin:20px 0}
.menu button{
  padding:8px 18px;
  font-weight:bold;
  border-radius:8px;
  border:1px solid #aaa;
  background:#f4f4f4;
  cursor:pointer;
}
.menu button:hover{background:#e6e6e6}

.section{display:none}
.section.active{display:block}

label{display:inline-block;width:180px}
input,select{width:280px;margin-bottom:6px}

.wrapper{height:70vh;overflow:auto;border:1px solid #ccc}
svg{width:4000px;height:2500px}

.node rect{fill:#fffdf8;stroke:#555;rx:10;ry:10}
.link{fill:none;stroke:#999}

.locked{opacity:.4}
.admin-tools{text-align:center;margin-top:20px}
.admin-tools button{margin:6px}
</style>
</head>

<body>
<div class="main">
<h1 style="text-align:center">GIA PHáº¢ DÃ’NG Há»Œ LÃŠ ÄÃŒNH</h1>

<div class="menu">
  <button onclick="show('home')">ğŸ  Trang chá»§</button>
  <button onclick="show('manage')">âœï¸ Quáº£n lÃ½</button>
  <button onclick="show('tree')">ğŸŒ³ Gia pháº£</button>
  <button onclick="adminLogin()">ğŸ” Admin</button>
</div>

<!-- ================= TRANG CHá»¦ ================= -->
<div id="home" class="section active">
<h2 style="text-align:center">Lá»œI GIá»šI THIá»†U</h2>

<p>
Gia pháº£ lÃ  sá»£i dÃ¢y ná»‘i liá»n cÃ¡c tháº¿ há»‡, lÃ  nÆ¡i lÆ°u giá»¯ cá»™i nguá»“n,
cÃ´ng Ä‘á»©c tá»• tiÃªn vÃ  truyá»n thá»‘ng cá»§a dÃ²ng há» qua bao Ä‘á»i.
</p>

<p>
DÃ²ng há» LÃª chÃºng ta láº¥y <b>Thá»§y tá»• lÃ  Cá»¥ LÃª ÄÃ¬nh Cai</b>,
con trai cá»§a <b>HoÃ ng thÃ¢n LÃª Duy Máº­t</b>, lÃ m gá»‘c.
Tá»« Thá»§y tá»•, cÃ¡c Ä‘á»i con chÃ¡u tiáº¿p ná»‘i sinh sÃ´i, láº­p nghiá»‡p,
Ä‘Ã³ng gÃ³p cho gia Ä‘Ã¬nh, quÃª hÆ°Æ¡ng vÃ  Ä‘áº¥t nÆ°á»›c.
</p>

<p>
Tráº£i qua thá»i gian, nhiá»u tÆ° liá»‡u gia pháº£ báº±ng giáº¥y Ä‘Ã£ mai má»™t,
phÃ¢n tÃ¡n hoáº·c khÃ³ báº£o quáº£n. Viá»‡c xÃ¢y dá»±ng Gia pháº£ Ä‘iá»‡n tá»­ nháº±m:
</p>

<ul style="margin-left:30px">
  <li>GÃ¬n giá»¯ Ä‘áº§y Ä‘á»§, chÃ­nh xÃ¡c thÃ´ng tin cÃ¡c tháº¿ há»‡ trong dÃ²ng há»</li>
  <li>GiÃºp con chÃ¡u dá»… dÃ ng tra cá»©u cá»™i nguá»“n, vai váº¿, thá»© báº­c</li>
  <li>Thuáº­n tiá»‡n trong viá»‡c tá»• chá»©c giá»— tá»•, giá»— chi, tÆ°á»Ÿng nhá»› tá»• tiÃªn</li>
  <li>Káº¿t ná»‘i con chÃ¡u trong vÃ  ngoÃ i nÆ°á»›c, dÃ¹ á»Ÿ báº¥t cá»© nÆ¡i Ä‘Ã¢u</li>
</ul>

<p>
Gia pháº£ Ä‘iá»‡n tá»­ nÃ y Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn tinh tháº§n
<b>tÃ´n trá»ng lá»‹ch sá»­ â€“ giá»¯ gÃ¬n truyá»n thá»‘ng â€“ truyá»n láº¡i cho mai sau</b>.
Má»i thÃ´ng tin Ä‘á»u Ä‘Æ°á»£c Ban gia pháº£ rÃ  soÃ¡t, bá»• sung vÃ  cáº­p nháº­t cáº©n trá»ng.
</p>

<p>
Nguyá»‡n mong con chÃ¡u Ä‘á»i sau, khi xem gia pháº£,
luÃ´n nhá»› Ä‘áº¿n cÃ´ng lao tá»• tiÃªn, giá»¯ gÃ¬n ná» náº¿p gia phong,
Ä‘oÃ n káº¿t yÃªu thÆ°Æ¡ng, cÃ¹ng nhau lÃ m ráº¡ng danh dÃ²ng há».
</p>

<p>
Gia pháº£ nÃ y lÃ  <b>tÃ i sáº£n chung cá»§a toÃ n thá»ƒ dÃ²ng há»</b>,
Ä‘Æ°á»£c lÆ°u giá»¯ vÃ  sá»­ dá»¥ng cho má»¥c Ä‘Ã­ch tÆ°á»Ÿng nhá»› tá»• tiÃªn
vÃ  giÃ¡o dá»¥c truyá»n thá»‘ng cho cÃ¡c tháº¿ há»‡ mai sau.
</p>

<p style="text-align:right;font-weight:bold;margin-top:30px">
Ban Gia pháº£ dÃ²ng há» LÃª ÄÃ¬nh
</p>
</div>

<!-- ================= QUáº¢N LÃ ================= -->
<div id="manage" class="section">
<div id="manageBox">
<b>ThÃªm / chá»‰nh sá»­a thÃ nh viÃªn</b><br><br>

<label>Cha:</label>
<select id="parentSelect"></select><br>

<label>Há» tÃªn:</label>
<input id="nameInput"><br>

<label>Con thá»© máº¥y:</label>
<input id="orderInput"><br>

<label>NÄƒm sinh:</label>
<input id="birthInput"><br>

<label>QuÃª quÃ¡n:</label>
<input id="homeInput"><br>

<label>NgÃ y giá»—:</label>
<input id="deathInput"><br><br>

<button onclick="addChild()">â• ThÃªm</button>
<button onclick="updateNode()">âœï¸ Cáº­p nháº­t</button>
</div>

<div class="admin-tools" id="adminTools" style="display:none">
<hr>
<button onclick="adminLogout()">ğŸšª ÄÄƒng xuáº¥t Admin</button>
<button onclick="backupData()">ğŸ’¾ Sao lÆ°u</button>
<button onclick="restoreData()">â™»ï¸ Phá»¥c há»“i</button>
<button onclick="printTree()">ğŸ–¨ï¸ In / Xuáº¥t PDF</button>
</div>

<p id="lockNote" style="color:#900;font-weight:bold">
ğŸ”’ Chá»‰ Admin má»›i Ä‘Æ°á»£c phÃ©p chá»‰nh sá»­a
</p>
</div>

<!-- ================= CÃ‚Y ================= -->
<div id="tree" class="section">
<div class="wrapper"><svg></svg></div>
</div>
</div>

<script>
function show(id){
 document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
 document.getElementById(id).classList.add('active');
}

/* ADMIN */
const ADMIN_PASSWORD="ledinh123";
let ADMIN=false;

function lock(){
 document.querySelectorAll("#manageBox input,#manageBox select,#manageBox button")
  .forEach(e=>e.disabled=true);
 document.getElementById("lockNote").style.display="block";
 document.getElementById("adminTools").style.display="none";
}

function unlock(){
 document.querySelectorAll("#manageBox input,#manageBox select,#manageBox button")
  .forEach(e=>e.disabled=false);
 document.getElementById("lockNote").style.display="none";
 document.getElementById("adminTools").style.display="block";
}

function adminLogin(){
 let p=prompt("Nháº­p máº­t kháº©u Admin:");
 if(p===ADMIN_PASSWORD){
  ADMIN=true;
  unlock();
  alert("ÄÃ£ vÃ o cháº¿ Ä‘á»™ Admin");
 } else alert("Sai máº­t kháº©u");
}

function adminLogout(){
 ADMIN=false;
 lock();
 alert("ÄÃ£ Ä‘Äƒng xuáº¥t Admin");
}

lock();

/* DATA */
let data={id:1,name:"Thá»§y Tá»• â€“ LÃª ÄÃ¬nh Cai",doi:1,children:[]};
let selectedId=null;

function all(n,a=[]){a.push(n);(n.children||[]).forEach(c=>all(c,a));return a;}

function refresh(){
 parentSelect.innerHTML="";
 all(data).forEach(n=>parentSelect.add(new Option(n.name,n.id)));
}

/* ADD */
function addChild(){
 if(!ADMIN) return alert("Chá»‰ Admin Ä‘Æ°á»£c thÃªm");
 let p=all(data).find(n=>n.id==parentSelect.value);
 if(!nameInput.value.trim()) return alert("Pháº£i nháº­p Há»Œ TÃŠN");
 p.children.push({id:Date.now(),name:nameInput.value.trim(),doi:p.doi+1,children:[]});
 draw();refresh();
}

/* UPDATE */
function updateNode(){
 if(!ADMIN||!selectedId||selectedId===1) return;
 let p=all(data).find(n=>n.id===selectedId);
 p.name=nameInput.value.trim();
 draw();
}

/* BACKUP */
function backupData(){
 const a=document.createElement("a");
 a.href=URL.createObjectURL(new Blob([JSON.stringify(data,null,2)],{type:"application/json"}));
 a.download="gia-pha-ledinh.json";
 a.click();
}

/* RESTORE */
function restoreData(){
 const i=document.createElement("input");
 i.type="file";
 i.onchange=e=>{
  const r=new FileReader();
  r.onload=()=>{data=JSON.parse(r.result);draw();refresh();}
  r.readAsText(e.target.files[0]);
 }
 i.click();
}

/* PRINT */
function printTree(){window.print();}

/* DRAW */
function draw(){
 d3.select("svg").selectAll("*").remove();
 let g=d3.select("svg").append("g").attr("transform","translate(200,400)");
 let root=d3.hierarchy(data,d=>d.children);
 d3.tree().nodeSize([150,260])(root);

 g.selectAll(".link").data(root.links()).enter().append("path")
 .attr("class","link")
 .attr("d",d3.linkHorizontal().x(d=>d.y).y(d=>d.x));

 g.selectAll(".node").data(root.descendants()).enter().append("g")
 .attr("class","node")
 .attr("transform",d=>`translate(${d.y},${d.x})`)
 .on("click",(e,d)=>{if(ADMIN){selectedId=d.data.id;nameInput.value=d.data.name}})
 .call(n=>{
  n.append("rect").attr("x",-120).attr("y",-40).attr("width",240).attr("height",80);
  n.append("text").attr("text-anchor","middle").attr("y",0).text(d=>d.data.name);
 });
}
refresh();draw();
</script>
</body>
</html>
